{
    "directed": true,
    "multigraph": false,
    "graph": {
        "session_id": "3D_10242023",
        "is_mion": false,
        "scan_pos": "HFP",
        "reg_settings": {
            "nonlinear_moco": false,
            "nonlinear_session_2_functional_rep": false,
            "topup": false
        }
    },
    "nodes": [
        {
            "data": [
                "subjects/Geo_Sim_TD/sessions/3D_10242023/probe_colored_circle_minus_gray.nii.gz",
                "subjects/Geo_Sim_TD/sessions/3D_10242023/probe_chromatic_uncolored_minus_gray.nii.gz",
                "subjects/Geo_Sim_TD/sessions/3D_10242023/probe_chromatic_uncolored_minus_colored_circle.nii.gz",
                "subjects/Geo_Sim_TD/sessions/3D_10242023/background.nii.gz"
            ],
            "complete": null,
            "bipartite": 0,
            "generated": true,
            "modified": "2023-10-24 11:42:46.623641",
            "id": "end"
        },
        {
            "data": [],
            "type": "volume",
            "bipartite": 0,
            "complete": false,
            "space": "epi_native",
            "leaf": true,
            "id": "other_images"
        },
        {
            "data": [
                "subjects/Geo_Sim_TD/sessions/3D_10242023/1/f.nii.gz"
            ],
            "type": "time_series",
            "bipartite": 0,
            "complete": true,
            "space": "epi_native",
            "leaf": true,
            "modified": "2023-10-24 10:18:34.096735",
            "id": "raw_epi"
        },
        {
            "data": [
                "subjects/Geo_Sim_TD/sessions/3D_10242023/1/f_nordic.nii.gz"
            ],
            "type": "time_series",
            "bipartite": 0,
            "complete": true,
            "space": "epi_native",
            "modified": "2023-10-24 10:28:08.086303",
            "id": "nordic_epi"
        },
        {
            "data": [
                "subjects/Geo_Sim_TD/sessions/3D_10242023/1/slc.nii.gz"
            ],
            "type": "time_series",
            "bipartite": 0,
            "complete": true,
            "space": "epi_native",
            "leaf": true,
            "modified": "2023-10-24 10:45:39.841670",
            "id": "topup_epi"
        },
        {
            "data": [
                "subjects/Geo_Sim_TD/sessions/3D_10242023/1/slc_sphinx.nii.gz"
            ],
            "type": "time_series",
            "bipartite": 0,
            "complete": true,
            "space": "epi_native",
            "modified": "2023-10-24 10:52:17.081464",
            "id": "sphinx_epi"
        },
        {
            "data": [
                "subjects/Geo_Sim_TD/sessions/3D_10242023/1/moco.nii.gz"
            ],
            "type": "time_series",
            "bipartite": 0,
            "complete": true,
            "space": "epi_native",
            "modified": "2023-10-24 11:07:30.337628",
            "id": "moco_epi"
        },
        {
            "data": [
                "subjects/Geo_Sim_TD/sessions/3D_10242023/1/slc.nii.gz"
            ],
            "type": "time_series",
            "bipartite": 0,
            "complete": true,
            "space": "epi_native",
            "modified": "2023-10-24 10:33:06.639000",
            "id": "slice_time_corrected_epi"
        },
        {
            "data": "subjects/Geo_Sim_TD/sessions/3D_10242023/3d_epi_rep.nii.gz",
            "type": "volume",
            "bipartite": 0,
            "complete": true,
            "space": "epi_native",
            "modified": "2023-10-24 11:01:43.307878",
            "id": "3d_epi_rep"
        },
        {
            "data": "../../../../../../media/ssbeast/mturk/MTurk1/subjects/Geo_Sim_TD/sessions/3D_10242023/3d_epi_rep_sphinx.nii.gz",
            "type": "volume",
            "bipartite": 0,
            "complete": true,
            "space": "epi_native",
            "leaf": true,
            "modified": "2023-10-24 11:02:05.942264",
            "id": "3d_epi_rep_sphinx"
        },
        {
            "data": "/home/ssbeast/Projects/SS/monkey_fmri/MTurk1/subjects/Geo_Sim_TD/mri/functional_target.nii.gz",
            "type": "volume",
            "bipartite": 0,
            "complete": null,
            "space": "epi_std",
            "leaf": true,
            "modified": "2023-10-20 14:34:08.564398",
            "id": "functional_std"
        },
        {
            "data": "../../../../home/ssbeast/Projects/SS/monkey_fmri/MTurk1/subjects/Geo_Sim_TD/mri/inverse_trans_dil_ds_Z10_100Mask.nii.gz",
            "type": "volume",
            "bipartite": 0,
            "complete": null,
            "space": "epi_std",
            "leaf": true,
            "modified": "2023-10-20 14:40:07.194155",
            "id": "functional_std_dil_mask"
        },
        {
            "data": "../../../../home/ssbeast/Projects/SS/monkey_fmri/MTurk1/subjects/Geo_Sim_TD/mri/inverse_trans_ds_Z10_100Mask.nii.gz",
            "type": "volume",
            "bipartite": 0,
            "complete": null,
            "space": "epi_std",
            "leaf": true,
            "modified": "2023-10-20 14:39:20.967038",
            "id": "functional_std_mask"
        },
        {
            "data": "../../../../home/ssbeast/Projects/SS/monkey_fmri/MTurk1/subjects/Geo_Sim_TD/mri/masked_functional_target.nii.gz",
            "type": "volume",
            "bipartite": 0,
            "complete": null,
            "space": "epi_std",
            "leaf": true,
            "modified": "2023-10-20 14:40:52.990208",
            "id": "functional_std_masked"
        },
        {
            "data": "subjects/Geo_Sim_TD/sessions/3D_10242023/itkManual.nii.gz",
            "type": "volume",
            "bipartite": 0,
            "complete": true,
            "space": "epi_std_aprox",
            "modified": "2023-10-24 11:15:03.658956",
            "id": "manual_reg_epi_rep"
        },
        {
            "data": "subjects/Geo_Sim_TD/sessions/3D_10242023/masked_itkManual.nii.gz",
            "type": "volume",
            "bipartite": 0,
            "complete": true,
            "space": "epi_std_aprox",
            "leaf": true,
            "modified": "2023-10-24 11:17:28.538772",
            "id": "masked_manual_reg_epi_rep"
        },
        {
            "data": "subjects/Geo_Sim_TD/sessions/3D_10242023/itkManual.txt",
            "type": "transform",
            "bipartite": 0,
            "complete": true,
            "invertable": true,
            "space": [
                "epi_native",
                "epi_std_aprox"
            ],
            "leaf": true,
            "modified": "2023-10-24 11:15:03.658956",
            "id": "manual_transform"
        },
        {
            "data": "subjects/Geo_Sim_TD/sessions/3D_10242023/Composite.h5",
            "type": "transform",
            "bipartite": 0,
            "complete": true,
            "invertable": false,
            "space": [
                "epi_std_aprox",
                "epi_std"
            ],
            "leaf": true,
            "modified": "2023-10-24 11:17:57.743614",
            "id": "auto_composite_transform"
        },
        {
            "data": "subjects/Geo_Sim_TD/sessions/3D_10242023/InverseComposite.h5",
            "type": "transform",
            "bipartite": 0,
            "complete": true,
            "invertable": false,
            "space": [
                "epi_std",
                "epi_std_aprox"
            ],
            "leaf": true,
            "modified": "2023-10-24 11:17:57.743614",
            "id": "inverse_auto_composite_transform"
        },
        {
            "data": [
                "subjects/Geo_Sim_TD/sessions/3D_10242023/1/reg_moco.nii.gz"
            ],
            "fname": null,
            "type": "time_series",
            "bipartite": 0,
            "complete": true,
            "space": "epi_native",
            "modified": "2023-10-24 11:25:58.282715",
            "id": "reg_epi"
        },
        {
            "data": [],
            "fname": null,
            "type": "csv",
            "bipartite": 0,
            "complete": false,
            "leaf": true,
            "space": "time_course",
            "id": "fixation_data"
        },
        {
            "data": [
                "subjects/Geo_Sim_TD/sessions/3D_10242023/1/epi_masked.nii.gz"
            ],
            "fname": null,
            "type": "time_series",
            "bipartite": 0,
            "complete": true,
            "leaf": true,
            "modified": "2023-10-24 11:30:54.471271",
            "id": "reg_epi_masked"
        },
        {
            "data": "paradigms/validate_decoder_experiment_config.json",
            "type": "json",
            "bipartite": 0,
            "complete": true,
            "leaf": true,
            "modified": "2023-10-24 11:33:13.570760",
            "id": "paradigm"
        },
        {
            "type": "json",
            "bipartite": 0,
            "complete": true,
            "data": "subjects/Geo_Sim_TD/sessions/3D_10242023/ima_order_map.json",
            "leaf": true,
            "modified": "2023-10-24 11:35:17.181588",
            "id": "ima_order_map"
        },
        {
            "data": "subjects/Geo_Sim_TD/sessions/3D_10242023/glm_model_334306.pkl",
            "type": "glm_object",
            "bipartite": 0,
            "complete": true,
            "space": "epi_std",
            "leaf": true,
            "modified": "2023-10-24 11:42:26.183697",
            "id": "glm_model"
        },
        {
            "data": [
                "subjects/Geo_Sim_TD/sessions/3D_10242023/probe_colored_circle_minus_gray.nii.gz",
                "subjects/Geo_Sim_TD/sessions/3D_10242023/probe_chromatic_uncolored_minus_gray.nii.gz",
                "subjects/Geo_Sim_TD/sessions/3D_10242023/probe_chromatic_uncolored_minus_colored_circle.nii.gz",
                "subjects/Geo_Sim_TD/sessions/3D_10242023/background.nii.gz"
            ],
            "type": "volume",
            "bipartite": 0,
            "complete": true,
            "space": "epi_std",
            "leaf": true,
            "modified": "2023-10-24 11:42:46.623641",
            "id": "reg_contrasts"
        },
        {
            "data": null,
            "type": "std_image",
            "bipartite": 0,
            "complete": false,
            "space": "",
            "modified": "2023-10-24 11:42:46.623641",
            "id": "slice_contrast_img"
        },
        {
            "data": "subjects/Geo_Sim_TD/sessions/3D_10242023/glm_model_334306.pkl",
            "type": "ndarray",
            "bipartite": 0,
            "complete": true,
            "space": "",
            "modified": "2023-10-24 11:42:26.183697",
            "id": "hrf_estimate"
        },
        {
            "argv": "3D_10242023",
            "fxn": "support_functions.get_images",
            "bipartite": 1,
            "desc": "Accept user input for path to session directory, load images into a dump exp",
            "id": "get_images"
        },
        {
            "fxn": "support_functions.get_fixation_csv",
            "bipartite": 1,
            "desc": "",
            "id": "get_fixation_data"
        },
        {
            "argv": "3D_10242023",
            "fxn": "support_functions.get_epis",
            "bipartite": 1,
            "desc": "Accept user input for path to session directory containing directories of dicoms or a nifti, and load the data into project format (freesurfer convention)",
            "modified": "2023-10-24 10:18:34.096735",
            "id": "get_epi"
        },
        {
            "fxn": "support_functions.nordic_correction_wrapper",
            "bipartite": 1,
            "desc": "Apply Steen Moeller of UMN 's very nice thermal noise correction matlab script to our raw epis. Need to provide a thermal noise image path, ideally collected in the same session or otherwise a close of one as possible. Must have cloned the SteenMoeller/NORDIC_raw github and added it to matlab path.",
            "modified": "2023-10-24 10:28:08.086303",
            "id": "noise_correct"
        },
        {
            "fxn": "support_functions.topup_wrapper",
            "bipartite": 1,
            "desc": "Use two reverse phase encoded Spin-Echo images to correct the magnetic field distortions in the functional image. ",
            "modified": "2023-10-24 10:45:39.841670",
            "argv": false,
            "id": "topup"
        },
        {
            "fxn": "preprocess.convert_to_sphinx",
            "bipartite": 1,
            "desc": "Preform Sphinx orientation correction on the 4d raw epi data",
            "modified": "2023-10-24 10:52:17.081464",
            "argv": "HFP",
            "id": "sphinx_correct"
        },
        {
            "fxn": "support_functions.motion_correction_wrapper",
            "bipartite": 1,
            "desc": "Linear motion correction to target 3D rep image. All frames in whole session are affine aligned to this target, using mutual information cost. Uses either FSL MCFLIRT or ANTs motion correction under the hood depending on package availability. FSL is preferred due to faster runtimes with similar results. If multiple targets are provided,returns motion correction that resulted in lowest displacement",
            "modified": "2023-10-24 11:07:30.337628",
            "argv": false,
            "id": "motion_correction"
        },
        {
            "fxn": "preprocess.slice_time_correction",
            "bipartite": 1,
            "desc": "Preforms slice timing correction on motion corrected functional data. Uses slice 0 as reference. In current version assumes axial slices and interleaved acquisition.",
            "modified": "2023-10-24 10:33:06.639000",
            "id": "slice_timing_correction"
        },
        {
            "fxn": "support_functions.get_3d_rep",
            "bipartite": 1,
            "argv": true,
            "desc": "Selects a frame from the middle of the run to use as the functional 3d representative volume. This volume defines the functional space. Each session has a unique functional space, though they likely are very similar",
            "modified": "2023-10-24 11:01:43.307878",
            "id": "select_3d_rep"
        },
        {
            "fxn": "support_functions.convert_to_sphinx_vol_wrap",
            "bipartite": 1,
            "desc": "Preform sphinx orientaion correction on the representative epi volume.",
            "modified": "2023-10-24 11:02:05.942264",
            "argv": "HFP",
            "id": "sphinx_correct_3d_rep"
        },
        {
            "fxn": "support_functions.itk_manual",
            "bipartite": 1,
            "desc": "Use ITK-Snap to preform a course grain manual registration between the epi rep volume and the downsampled t1, creating a crude linear mapping between the functional and working space. It is most important that the borders of the cortex closely match, since this map is used for  brain masking the epi rep.",
            "modified": "2023-10-24 11:15:03.658956",
            "id": "manual_registration"
        },
        {
            "fxn": "support_functions.coreg_wrapper",
            "bipartite": 1,
            "desc": "Use ants coregistration to create a fine grained nonlinear mapping from the skull stripped manually aligned epi rep to the downsampled t1. The manual registration got the brains as overlapping as possible, now this attempts to morph the cortex to correct differences in white matter boundaries due to field warp in epi acquisition.",
            "argv": false,
            "modified": "2023-10-24 11:17:57.743614",
            "id": "automatic_coregistration"
        },
        {
            "fxn": "support_functions.apply_binary_mask_vol",
            "bipartite": 1,
            "desc": "Applys the downsampled t1 mask to the epi rep thats been manually registered to the ds t1, so that the epi can be nonlinear coregistered to the t1 without intereference from the skull",
            "modified": "2023-10-24 11:17:28.538772",
            "id": "apply_reg_epi_mask"
        },
        {
            "fxn": "support_functions.apply_binary_mask_functional",
            "bipartite": 1,
            "desc": "Applys the functional std space mask to the session epis warped to the standard functional space",
            "modified": "2023-10-24 11:30:54.471271",
            "id": "apply_functional_mask"
        },
        {
            "fxn": "support_functions.create_load_paradigm",
            "bipartite": 1,
            "desc": "Either load an existing stimuli paradigm json config file, or use the prompt to create a new one.",
            "modified": "2023-10-24 11:33:13.570760",
            "id": "load_paradigm"
        },
        {
            "fxn": "support_functions.create_load_ima_order_map",
            "bipartite": 1,
            "desc": "Map each epi ima number to a corresponding stimuli paradigm order number.",
            "modified": "2023-10-24 11:35:17.181588",
            "id": "create_load_ima_order_map"
        },
        {
            "fxn": "support_functions.get_beta_matrix",
            "bipartite": 1,
            "argv": false,
            "desc": "Create the size voxels x stimulus_conditions beta matrix from paradigm def and session masked epis. The beta matrix is designed to capture the information we careabout from this experiment, and satisfies the equation (DesignMatrix * hrf) @ BetaMatrix ~= EpiTimeSeries where * is the convolution operator and @ is matrix multiplication.",
            "modified": "2023-10-24 11:42:26.183697",
            "id": "create_beta_matrix"
        },
        {
            "fxn": "support_functions.apply_warp_4d_refactor",
            "bipartite": 1,
            "desc": "Use the functional -> working space transform to take the functional data to the working space. ",
            "modified": "2023-10-24 11:25:58.282715",
            "id": "register_epis"
        },
        {
            "fxn": "support_functions.create_contrast",
            "bipartite": 1,
            "desc": "Create contrast volumes from the beta matrix.",
            "modified": "2023-10-24 11:42:46.623641",
            "id": "create_session_contrast"
        },
        {
            "argv": "3D_10242023",
            "fxn": "support_functions.promote_session",
            "bipartite": 1,
            "desc": "This session is marked as complete-ish and will be included by future subject level analysis, and for construction of the subject level beta matrix. Basically its added to the subject config data index.",
            "modified": "2023-10-24 11:44:18.932273",
            "id": "promote_session"
        },
        {
            "argv": "3D_10242023",
            "fxn": "support_functions.demote_session",
            "bipartite": 1,
            "desc": "Removes this session from subject config data index. It will no longer be included in future subject level analysis.",
            "id": "demote_session"
        },
        {
            "fxn": "support_functions.create_slice_overlays",
            "bipartite": 1,
            "id": "contrast_slice_overlay"
        },
        {
            "fxn": "self.sterilize",
            "bipartite": 1,
            "generated": true,
            "desc": "function that removes intermediate files associated with session. WARNING: This makes it impossible to re-run many intermediate processing steps without starting over.",
            "id": "sterilize"
        }
    ],
    "links": [
        {
            "order": 0,
            "source": "raw_epi",
            "target": "get_images"
        },
        {
            "order": 0,
            "source": "raw_epi",
            "target": "get_fixation_data"
        },
        {
            "order": 0,
            "source": "raw_epi",
            "target": "noise_correct"
        },
        {
            "order": 0,
            "source": "nordic_epi",
            "target": "slice_timing_correction"
        },
        {
            "order": 0,
            "source": "topup_epi",
            "target": "sphinx_correct"
        },
        {
            "order": 0,
            "source": "topup_epi",
            "target": "select_3d_rep"
        },
        {
            "order": 0,
            "source": "sphinx_epi",
            "target": "motion_correction"
        },
        {
            "order": 0,
            "source": "moco_epi",
            "target": "register_epis"
        },
        {
            "order": 0,
            "source": "slice_time_corrected_epi",
            "target": "topup"
        },
        {
            "order": 0,
            "source": "3d_epi_rep",
            "target": "sphinx_correct_3d_rep"
        },
        {
            "order": 1,
            "source": "3d_epi_rep_sphinx",
            "target": "motion_correction"
        },
        {
            "order": 0,
            "source": "3d_epi_rep_sphinx",
            "target": "manual_registration"
        },
        {
            "order": 1,
            "source": "functional_std",
            "target": "manual_registration"
        },
        {
            "order": 1,
            "source": "functional_std",
            "target": "register_epis"
        },
        {
            "order": 1,
            "source": "functional_std_dil_mask",
            "target": "apply_reg_epi_mask"
        },
        {
            "order": 1,
            "source": "functional_std_mask",
            "target": "apply_functional_mask"
        },
        {
            "order": 1,
            "source": "functional_std_masked",
            "target": "automatic_coregistration"
        },
        {
            "order": 1,
            "source": "functional_std_masked",
            "target": "contrast_slice_overlay"
        },
        {
            "order": 0,
            "source": "manual_reg_epi_rep",
            "target": "apply_reg_epi_mask"
        },
        {
            "order": 0,
            "source": "masked_manual_reg_epi_rep",
            "target": "automatic_coregistration"
        },
        {
            "order": 2,
            "source": "manual_transform",
            "target": "register_epis"
        },
        {
            "order": 3,
            "source": "auto_composite_transform",
            "target": "register_epis"
        },
        {
            "order": 0,
            "source": "reg_epi",
            "target": "apply_functional_mask"
        },
        {
            "order": 0,
            "source": "reg_epi_masked",
            "target": "create_load_ima_order_map"
        },
        {
            "order": 0,
            "source": "reg_epi_masked",
            "target": "create_beta_matrix"
        },
        {
            "order": 2,
            "source": "reg_epi_masked",
            "target": "promote_session"
        },
        {
            "order": 0,
            "source": "reg_epi_masked",
            "target": "contrast_slice_overlay"
        },
        {
            "order": 1,
            "source": "paradigm",
            "target": "create_beta_matrix"
        },
        {
            "order": 1,
            "source": "paradigm",
            "target": "promote_session"
        },
        {
            "order": 0,
            "source": "paradigm",
            "target": "demote_session"
        },
        {
            "order": 1,
            "source": "paradigm",
            "target": "create_session_contrast"
        },
        {
            "order": 2,
            "source": "ima_order_map",
            "target": "create_beta_matrix"
        },
        {
            "order": 3,
            "source": "ima_order_map",
            "target": "promote_session"
        },
        {
            "order": 0,
            "source": "glm_model",
            "target": "promote_session"
        },
        {
            "order": 0,
            "source": "glm_model",
            "target": "create_session_contrast"
        },
        {
            "order": 2,
            "source": "reg_contrasts",
            "target": "contrast_slice_overlay"
        },
        {
            "order": 0,
            "source": "get_images",
            "target": "other_images"
        },
        {
            "order": 0,
            "source": "get_fixation_data",
            "target": "fixation_data"
        },
        {
            "order": 0,
            "source": "get_epi",
            "target": "raw_epi"
        },
        {
            "order": 0,
            "source": "noise_correct",
            "target": "nordic_epi"
        },
        {
            "order": 0,
            "source": "topup",
            "target": "topup_epi"
        },
        {
            "order": 0,
            "source": "sphinx_correct",
            "target": "sphinx_epi"
        },
        {
            "order": 0,
            "source": "motion_correction",
            "target": "moco_epi"
        },
        {
            "order": 0,
            "source": "slice_timing_correction",
            "target": "slice_time_corrected_epi"
        },
        {
            "order": 0,
            "source": "select_3d_rep",
            "target": "3d_epi_rep"
        },
        {
            "order": 0,
            "source": "sphinx_correct_3d_rep",
            "target": "3d_epi_rep_sphinx"
        },
        {
            "order": 0,
            "source": "manual_registration",
            "target": "manual_transform"
        },
        {
            "order": 1,
            "source": "manual_registration",
            "target": "manual_reg_epi_rep"
        },
        {
            "order": 0,
            "source": "automatic_coregistration",
            "target": "auto_composite_transform"
        },
        {
            "order": 1,
            "source": "automatic_coregistration",
            "target": "inverse_auto_composite_transform"
        },
        {
            "order": 0,
            "source": "apply_reg_epi_mask",
            "target": "masked_manual_reg_epi_rep"
        },
        {
            "order": 0,
            "source": "apply_functional_mask",
            "target": "reg_epi_masked"
        },
        {
            "order": 0,
            "source": "load_paradigm",
            "target": "paradigm"
        },
        {
            "order": 0,
            "source": "create_load_ima_order_map",
            "target": "ima_order_map"
        },
        {
            "order": 0,
            "source": "create_beta_matrix",
            "target": "glm_model"
        },
        {
            "order": 1,
            "source": "create_beta_matrix",
            "target": "hrf_estimate"
        },
        {
            "order": 0,
            "source": "register_epis",
            "target": "reg_epi"
        },
        {
            "order": 0,
            "source": "create_session_contrast",
            "target": "reg_contrasts"
        },
        {
            "order": 1,
            "source": "create_session_contrast",
            "target": "end"
        },
        {
            "order": 0,
            "source": "contrast_slice_overlay",
            "target": "slice_contrast_img"
        },
        {
            "order": 0,
            "source": "sterilize",
            "target": "end"
        }
    ]
}